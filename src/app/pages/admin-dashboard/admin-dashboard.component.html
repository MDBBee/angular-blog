<div
  class="admin-dashboard min-h-screen bg-background text-white p-8 rounded-xl"
>
  <!-- Header with Gradient -->
  <div class="mb-8 relative z-10">
    <h1 class="text-4xl font-bold mb-2">Dashboard</h1>
    <p class="text-foreground">
      Welcome back! Here's your comprehensive platform overview.
    </p>
    <div class="mt-4 flex gap-2 text-xs">
      <span class="px-3 py-1 rounded-full bg-green-500/20 text-green-400"
        >Last Updated: Just now</span
      >
      <span class="px-3 py-1 rounded-full bg-blue-500/20 text-blue-400"
        >System Status: Healthy</span
      >
    </div>
  </div>

  <!-- Loading State -->
  @if (isLoading()) {
    <div class="flex items-center justify-center h-96">
      <div class="text-center">
        <div class="animate-spin mb-4">
          <svg class="w-12 h-12 mx-auto" fill="none" viewBox="0 0 24 24">
            <circle
              class="opacity-25"
              cx="12"
              cy="12"
              r="10"
              stroke="currentColor"
              stroke-width="4"
            ></circle>
            <path
              class="opacity-75"
              fill="currentColor"
              d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
            ></path>
          </svg>
        </div>
        <p>Loading dashboard...</p>
      </div>
    </div>
  } @else if (error()) {
    <div class="bg-red-500/20 border border-red-500 rounded-lg p-6 mb-6">
      <p class="text-red-200">{{ error() }}</p>
    </div>
  } @else if (metrics()) {
    <!-- PRIMARY METRICS SECTION -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
      <app-stat-card
        [label]="'Total Users'"
        [value]="metrics()!.totalUsers"
        [icon]="'ðŸ‘¥'"
        [description]="'Active users on platform'"
        [showTrend]="true"
        [trend]="12"
      ></app-stat-card>
      <app-stat-card
        [label]="'Total Posts'"
        [value]="metrics()!.totalPosts"
        [icon]="'ðŸ“'"
        [description]="'Published articles'"
        [showTrend]="true"
        [trend]="8"
      ></app-stat-card>
      <app-stat-card
        [label]="'Total Engagement'"
        [value]="metrics()!.totalComments"
        [icon]="'ðŸ’¬'"
        [description]="'Comments & interactions'"
        [showTrend]="true"
        [trend]="15"
      ></app-stat-card>
      <app-stat-card
        [label]="'Avg Engagement'"
        [value]="metrics()!.engagementRate"
        [icon]="'ðŸ“Š'"
        [description]="'Comments per post'"
        [showTrend]="true"
        [trend]="5"
      ></app-stat-card>
    </div>

    <!-- SECONDARY METRICS ROW -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
      <app-stat-card
        [label]="'Active Users'"
        [value]="metrics()!.activeUsers"
        [icon]="'ðŸŸ¢'"
        [description]="'Users active this month'"
      ></app-stat-card>
      <app-stat-card
        [label]="'Avg Posts/User'"
        [value]="metrics()!.avgPostsPerUser"
        [icon]="'ðŸ“ˆ'"
        [description]="'Average per user'"
      ></app-stat-card>
      <app-stat-card
        [label]="'Growth Rate'"
        [value]="'24%'"
        [icon]="'ðŸš€'"
        [description]="'Month over month'"
        [showTrend]="true"
        [trend]="18"
      ></app-stat-card>
    </div>

    <!-- VISUALIZATION SECTION 1 - Primary Charts -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
      <!-- Topics Distribution Pie Chart -->
      @if (topicsPieChartData()) {
        <app-dashboard-card title="ðŸ“Š Content Distribution by Topic">
          <div class="h-80">
            <app-pie-chart [chartData]="topicsPieChartData()"></app-pie-chart>
          </div>
        </app-dashboard-card>
      }

      <!-- Engagement Over Time -->
      @if (engagementLineChartData()) {
        <app-dashboard-card title="ðŸ“ˆ Engagement Trend Analysis">
          <div class="h-80">
            <app-line-chart
              [chartData]="engagementLineChartData()"
            ></app-line-chart>
          </div>
        </app-dashboard-card>
      }
    </div>

    <!-- VISUALIZATION SECTION 3 - Activity -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
      <!-- Posts by Date -->
      @if (postsBarChartData()) {
        <app-dashboard-card title="ðŸ“… Posts Activity Timeline">
          <div class="h-80">
            <app-bar-chart [chartData]="postsBarChartData()"></app-bar-chart>
          </div>
        </app-dashboard-card>
      }

      <!-- Top Users Activity -->
      @if (userActivityBarChartData()) {
        <app-dashboard-card title="â­ Top Contributors">
          <div class="h-80">
            <app-bar-chart
              [chartData]="userActivityBarChartData()"
            ></app-bar-chart>
          </div>
        </app-dashboard-card>
      }
    </div>

    <!-- USERS OVERVIEW -->
    @if (filteredUserStats.length > 0) {
      <app-users-overview [users]="filteredUserStats"></app-users-overview>
    }

    <!-- FOOTER STATS -->
    <div class="mt-8 text-center text-xs text-muted-foreground">
      <p>
        Dashboard auto-refreshes every 30 seconds â€¢ Last sync:
        <span class="text-blue-400">Just now</span>
      </p>
    </div>
  }
</div>
